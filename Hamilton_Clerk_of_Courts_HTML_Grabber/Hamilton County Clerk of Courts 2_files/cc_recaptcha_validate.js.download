function createCookie(name, value, minutes) {
    var expires;
    if (minutes) {
        var date = new Date();
        date.setTime(date.getTime() + (minutes * 60 * 1000));
        expires = "; expires=" + date.toGMTString();
    }
    else {
        expires = "";
    }
    document.cookie = name + "=" + value + expires + ";path=/";
    // removing path   document.cookie = name + "=" + value + expires + "; path=/";
    // alert(name + "=" + value + expires + "; path=/");
    var c = getCookie(name);
    if (c == "") {
        alert("Unable to set cookie. Access to certain areas may be limited. Please enable cookies and try again");
    }
}

function getCookie(cname) {
    var name = cname + "=";
    var decodedCookie = decodeURIComponent(document.cookie);
    var ca = decodedCookie.split(';');
    for(var i = 0; i <ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}

// used for recaptcha v2. obsolete
var onReturnCallback = function(response)
{
    // alert('g-recaptcha-response: ' + grecaptcha.getResponse());
    var url='https://courtclerk.org/data/re_proxy.php?url=https://www.google.com/recaptcha/api/siteverify';
    frm = document.getElementById('cc_frm');
    // alert(frm.name);
    if (checkcc(frm) == false) {
        return false;
    }
    $.ajax({ 'url': url,
        dataType: 'json',
        data: { response: response },
        success: function( data ) {
            var res = data.success.toString();
            // alert( "User verified: " + res);
            if (res == 'true') {
                // create a cookie for the response field - this can be checked by asp scripts to lock out bots
                // createCookie("auth_token", response, 120);   // 120 minute recaptcha limit. google setting is less
                frm.submit();
                //document.getElementById('g-recaptcha').innerHTML = 'Thank you! press Submit';
            } else {
                // createCookie("auth_token", response, -1);   // expire cookie if invalid
            }
        } // end of success:
    }); // end of $.ajax
};

// used for recaptcha v2. obsolete
/*
function validateCaptcha()
{
    var recaptchaRes = grecaptcha.getResponse();
    var message = "";
    if(recaptchaRes.length == 0) {
        alert("Please complete the reCAPTCHA challenge!");
        return false;
    } else {
        // Add reCAPTCHA response to the POST
        form.recaptchaRes = recaptchaRes;
    }
    return true;
}
*/

function validateCaptcha()
{
    var response = document.getElementById('recaptchaResponse').value;
    var url='https://www.courtclerk.org/data/re_proxy.php?url=https://www.google.com/recaptcha/api/siteverify';
    frm = document.getElementById('cc_frm');
    //if (checkcc(frm) == false) {
    //    return false;
    //}
    var re_status = false;
    $.ajax({ 'url': url,
        dataType: 'json',
        data: { response: response },
        success: function( data ) {
            var res = data.success.toString();
            // alert( "User verified: " + res);
            if (res == 'true') {
                // create a cookie for the response field - this can be checked by asp scripts to lock out bots
                // createCookie("auth_token", response, 120);   // 120 minute recaptcha limit. google setting is less
                frm.submit();
                //document.getElementById('g-recaptcha').innerHTML = 'Thank you! press Submit';
                re_status = true;
            } else {
                err_msgs = '';
                for (i=0; i<data["error-codes"].length; i++) {
                    err_msgs += data["error-codes"][i]  + ' ';
                }
                alert( "reCAPTCHA v3 Failed. Please reload the page and try again.\nErr: " + err_msgs);
                // createCookie("auth_token", response, -1);   // expire cookie if invalid
                re_status = false;
            }
        } // end of success:
    }); // end of $.ajax
    return re_status;
}